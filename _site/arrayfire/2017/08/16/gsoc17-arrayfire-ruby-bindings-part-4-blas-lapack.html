<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/>

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/animate.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="/css/responsive.css">

    <link rel="icon" href="/images/zasper_logo.ico" type="image/gif" sizes="32x32">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VRJB8WTXR1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VRJB8WTXR1');
    </script>

    <title>Prasun's Blog</title>
  </head>
  <body>
    <section id="header-home">
      <nav class="navbar navbar-expand-lg">
        <div class="container">
          <a class="navbar-brand" href="/">
            <!-- <img src="images/logo.svg" alt="#"> -->
            Prasun's blog
          </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasMenu">
            <i class="fa fa-bars"></i>
          </button>
          <div class="navbar-collapse justify-content-center offcanvas offcanvas-top offcanvas-body" id="offcanvasMenu">
            <button type="button" class="colse-btn" data-bs-dismiss="offcanvas">
              <i class="fa fa-times"></i>
            </button>
            <div class="menu-right-btn mobile-menu-login-signup">
              <a href="/about" class="custom-btn btn-bg hover-bg">About</a>
            </div>
          </div>
          <div class="menu-right-btn justify-content-end">
            <a href="/about" class="custom-btn btn-bg hover-bg">About</a>
          </div>
        </div>
      </nav>
    </section>



    <section id="blog-sec">
      <div class="container">
        <div class="row">
          <div class="col-12 col-md-12 col-lg-9">
            <div class="blog-details-wraper">
              <div class="blog-main-image wow fadeInUp">
                <img src="/images/gsoc2017.png" alt="#">
              </div>

              <div class="blog-title wow fadeInUp">
                <h2>ArrayFire Ruby Bindings<br>(Part IV : BLAS and LAPACK routines)</h2>
              </div>

              <div class="blog-published-info wow fadeInUp">
                <span class="blog-post-date">16 August 2017 by</span>
                <span class="blog-post-author">Prasun Anand</span>
              </div>

              <div class="blog-description wow fadeInUp">
              	<p><p>This post covers how to use <code class="language-plaintext highlighter-rouge">BLAS</code> and <code class="language-plaintext highlighter-rouge">LAPACK</code> routines with <code class="language-plaintext highlighter-rouge">ArrayFire-rb</code>, and how these functions
have been implemented by creating Ruby bindings to ArrayFire C API.</p>

<p>The performance benchmarks for ArrayFire against NMatrix can be represented by the following figures.
The code used for benchmarking and generating the plots can be found <a href="https://github.com/prasunanand/arrayfire-rb-benchmark-suite">here</a>
and be used to reproduce similar plots.</p>

<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

<script type="text/javascript" src="https://code.highcharts.com/highcharts.js"></script>

<script type="text/javascript" src="https://code.highcharts.com/4.2.2/modules/exporting.js"></script>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>

<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.1.1/normalize.min.css" />

<h1 id="performance-metrics">Performance metrics</h1>
<div ng-app="resultApp">
    <div ng-controller="MainCtrl">
      <div class="block">
        <strong>BLAS Routines</strong>
        <div id="chartmat_mult" class="chart"></div>
      </div>
      <div class="block">
        <strong>LAPACK Routines</strong>
          <div id="chartdeterminant" class="chart"></div><br />
          <div id="chartlu_factorization" class="chart"></div><br />
      </div>
    </div>
  <script type="text/javascript" src="/assets/js/chart.js"></script>
</div>

<p>(Note: The above benchmarks have been done on an AMD FX 8350 octacore processor
and Nvidia GTX 750Ti GPU. CUDA backend of ArrayFire was used with double floating points.)</p>

<p>The figure shows that ArrayFire takes the least computation time of all.
ArrayFire is 3 e +6 times faster than NMatrix for JRuby and NMatrix for Ruby(not BLAS)
whereas 7 e +5 times faster than NMatrix for Ruby(using BLAS).</p>

<p>For LAPACK routines, like calculating determinant and lower-upper factorization,
ArrayFire is 100 times faster than NMatrix for JRuby
whereas 6 times faster than NMatrix for Ruby(using LAPACKE).</p>

<p>Lets take a look at the implementation.</p>

<h1 id="blas-routines">BLAS Routines</h1>

<p>All the BLAS methods are <code class="language-plaintext highlighter-rouge">singleton_methods</code>.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">Init_arrayfire</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">ArrayFire</span> <span class="o">=</span> <span class="n">rb_define_module</span><span class="p">(</span><span class="s">"ArrayFire"</span><span class="p">);</span>

  <span class="n">Blas</span> <span class="o">=</span> <span class="n">rb_define_class_under</span><span class="p">(</span><span class="n">ArrayFire</span><span class="p">,</span> <span class="s">"BLAS"</span><span class="p">,</span> <span class="n">rb_cObject</span><span class="p">);</span>
  <span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Blas</span><span class="p">,</span> <span class="s">"matmul"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_matmul</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
  <span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Blas</span><span class="p">,</span> <span class="s">"dot"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_dot</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
  <span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Blas</span><span class="p">,</span> <span class="s">"transpose"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_transpose</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="p">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">arf_matmul</code> and <code class="language-plaintext highlighter-rouge">arf_transpose</code> call <code class="language-plaintext highlighter-rouge">af_matmul</code> and <code class="language-plaintext highlighter-rouge">af_transpose</code> respectively.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">static</span> <span class="n">VALUE</span> <span class="nf">arf_matmul</span><span class="p">(</span><span class="n">VALUE</span> <span class="n">self</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">left_val</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">right_val</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">left_prop_val</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">right_prop_val</span><span class="p">){</span>

  <span class="n">afstruct</span><span class="o">*</span> <span class="n">left</span><span class="p">;</span>
  <span class="n">afstruct</span><span class="o">*</span> <span class="n">right</span><span class="p">;</span>
  <span class="n">afstruct</span><span class="o">*</span> <span class="n">result</span> <span class="o">=</span> <span class="n">ALLOC</span><span class="p">(</span><span class="n">afstruct</span><span class="p">);</span>

  <span class="n">Data_Get_Struct</span><span class="p">(</span><span class="n">left_val</span><span class="p">,</span> <span class="n">afstruct</span><span class="p">,</span> <span class="n">left</span><span class="p">);</span>
  <span class="n">Data_Get_Struct</span><span class="p">(</span><span class="n">right_val</span><span class="p">,</span> <span class="n">afstruct</span><span class="p">,</span> <span class="n">right</span><span class="p">);</span>

  <span class="n">af_mat_prop</span> <span class="n">left_mat_prop</span> <span class="o">=</span> <span class="n">arf_mat_type_from_rbsymbol</span><span class="p">(</span><span class="n">left_prop_val</span><span class="p">);</span>
  <span class="n">af_mat_prop</span> <span class="n">right_mat_prop</span> <span class="o">=</span> <span class="n">arf_mat_type_from_rbsymbol</span><span class="p">(</span><span class="n">right_prop_val</span><span class="p">);</span>

  <span class="n">af_matmul</span><span class="p">(</span><span class="o">&amp;</span><span class="n">result</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">,</span> <span class="n">left</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">,</span> <span class="n">right</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">,</span> <span class="n">left_mat_prop</span><span class="p">,</span> <span class="n">right_mat_prop</span><span class="p">);</span>

  <span class="n">af_print_array</span><span class="p">(</span><span class="n">result</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">Data_Wrap_Struct</span><span class="p">(</span><span class="n">CLASS_OF</span><span class="p">(</span><span class="n">left_val</span><span class="p">),</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">arf_free</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">VALUE</span> <span class="nf">arf_transpose</span><span class="p">(</span><span class="n">VALUE</span> <span class="n">self</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">input</span><span class="p">){</span>
  <span class="n">afstruct</span><span class="o">*</span> <span class="n">obj</span><span class="p">;</span>
  <span class="n">afstruct</span><span class="o">*</span> <span class="n">result</span> <span class="o">=</span> <span class="n">ALLOC</span><span class="p">(</span><span class="n">afstruct</span><span class="p">);</span>

  <span class="n">Data_Get_Struct</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">afstruct</span><span class="p">,</span> <span class="n">obj</span><span class="p">);</span>

  <span class="n">af_transpose</span><span class="p">(</span><span class="o">&amp;</span><span class="n">result</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">,</span> <span class="n">obj</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>

  <span class="n">af_print_array</span><span class="p">(</span><span class="n">result</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">Data_Wrap_Struct</span><span class="p">(</span><span class="n">CLASS_OF</span><span class="p">(</span><span class="n">input</span><span class="p">),</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">arf_free</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">af_matmul</code> expects the property of matrices passed to it. For example, <code class="language-plaintext highlighter-rouge">af_mat_prop AF_MAT_TRANS</code>
signifies that the matrix is transposed. So, to pass the symbols to Ruby C function arf_matmul, I
have used the code given below. I have creared a list of values <code class="language-plaintext highlighter-rouge">MAT_PROPERTIES</code> and a function
<code class="language-plaintext highlighter-rouge">arf_mat_type_from_symbol</code> which is responsible for figuring out <code class="language-plaintext highlighter-rouge">af_mat_prop</code> from the symbol.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">*</span><span class="p">,</span> <span class="kt">size_t</span><span class="o">&gt;</span> <span class="n">MAT_PROPERTIES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">{</span><span class="s">"AF_MAT_NONE"</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
  <span class="p">{</span><span class="s">"AF_MAT_TRANS"</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
  <span class="p">{</span><span class="s">"AF_MAT_CTRANS"</span><span class="p">,</span> <span class="mi">2</span><span class="p">},</span>
  <span class="p">{</span><span class="s">"AF_MAT_CONJ"</span><span class="p">,</span> <span class="mi">4</span><span class="p">},</span>
  <span class="p">{</span><span class="s">"AF_MAT_UPPER"</span><span class="p">,</span> <span class="mi">32</span><span class="p">},</span>
  <span class="p">{</span><span class="s">"AF_MAT_LOWER"</span><span class="p">,</span> <span class="mi">64</span><span class="p">},</span>
  <span class="p">{</span><span class="s">"AF_MAT_DIAG_UNIT"</span><span class="p">,</span> <span class="mi">128</span><span class="p">},</span>
  <span class="p">{</span><span class="s">"AF_MAT_SYM"</span><span class="p">,</span> <span class="mi">512</span><span class="p">},</span>
  <span class="p">{</span><span class="s">"AF_MAT_POSDEF"</span><span class="p">,</span> <span class="mi">1024</span><span class="p">},</span>
  <span class="p">{</span><span class="s">"AF_MAT_ORTHOG"</span><span class="p">,</span> <span class="mi">2048</span><span class="p">},</span>
  <span class="p">{</span><span class="s">"AF_MAT_TRI_DIAG"</span><span class="p">,</span> <span class="mi">4096</span><span class="p">},</span>
  <span class="p">{</span><span class="s">"AF_MAT_BLOCK_DIAG"</span><span class="p">,</span> <span class="mi">8192</span><span class="p">}</span>
<span class="p">};</span>


<span class="n">af_mat_prop</span> <span class="nf">arf_mat_type_from_rbsymbol</span><span class="p">(</span><span class="n">VALUE</span> <span class="n">sym</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">ID</span> <span class="n">sym_id</span> <span class="o">=</span> <span class="n">SYM2ID</span><span class="p">(</span><span class="n">sym</span><span class="p">);</span>

  <span class="k">for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">*</span><span class="p">,</span> <span class="kt">size_t</span><span class="o">&gt;::</span><span class="n">value_type</span><span class="o">&amp;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">MAT_PROPERTIES</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sym_id</span> <span class="o">==</span> <span class="n">rb_intern</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="n">first</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">static_cast</span><span class="o">&lt;</span><span class="n">af_mat_prop</span><span class="o">&gt;</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="n">second</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">VALUE</span> <span class="n">str</span> <span class="o">=</span> <span class="n">rb_any_to_s</span><span class="p">(</span><span class="n">sym</span><span class="p">);</span>
  <span class="n">rb_raise</span><span class="p">(</span><span class="n">rb_eArgError</span><span class="p">,</span> <span class="s">"invalid matrix type symbol (:%s) specified"</span><span class="p">,</span>
   <span class="n">RSTRING_PTR</span><span class="p">(</span><span class="n">str</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<p>So, now I can check if the bindings work successfully.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">rake</span> <span class="n">pry</span>
<span class="n">pry</span> <span class="o">-</span><span class="n">r</span> <span class="s1">'./lib/arrayfire.rb'</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">left</span> <span class="o">=</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">Af_Array</span><span class="p">.</span><span class="nf">new</span> <span class="mi">2</span> <span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span> <span class="p">,</span> <span class="mi">2</span> <span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="no">No</span> <span class="no">Name</span> <span class="no">Array</span>
<span class="p">[</span><span class="mi">3</span> <span class="mi">3</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
    <span class="mf">1.0000</span>     <span class="mf">4.0000</span>    <span class="o">-</span><span class="mf">5.0000</span>
    <span class="mf">4.0000</span>    <span class="mf">11.0000</span>     <span class="mf">8.0000</span>
    <span class="mf">6.0000</span>     <span class="mf">2.0000</span>    <span class="mf">10.0000</span>

<span class="o">=&gt;</span> <span class="c1">#&lt;ArrayFire::Af_Array:0x000000014e56c8&gt;</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">right</span> <span class="o">=</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">Af_Array</span><span class="p">.</span><span class="nf">new</span> <span class="mi">2</span> <span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="no">No</span> <span class="no">Name</span> <span class="no">Array</span>
<span class="p">[</span><span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
    <span class="mf">1.0000</span>    <span class="mf">10.0000</span>
    <span class="mf">0.0000</span>   <span class="o">-</span><span class="mf">11.0000</span>
    <span class="mf">8.0000</span>     <span class="mf">8.0000</span>

<span class="o">=&gt;</span> <span class="c1">#&lt;ArrayFire::Af_Array:0x00000001591db0&gt;</span>
<span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">BLAS</span><span class="p">.</span><span class="nf">matmul</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="ss">:AF_MAT_NONE</span><span class="p">,</span> <span class="ss">:AF_MAT_NONE</span><span class="p">)</span>
<span class="no">No</span> <span class="no">Name</span> <span class="no">Array</span>
<span class="p">[</span><span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
  <span class="o">-</span><span class="mf">39.0000</span>   <span class="o">-</span><span class="mf">74.0000</span>
   <span class="mf">68.0000</span>   <span class="o">-</span><span class="mf">17.0000</span>
   <span class="mf">86.0000</span>   <span class="mf">118.0000</span>

<span class="o">=&gt;</span> <span class="c1">#&lt;ArrayFire::Af_Array:0x000000016136f8&gt;</span>
<span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">transposed</span> <span class="o">=</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">BLAS</span><span class="p">.</span><span class="nf">transpose</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
<span class="no">No</span> <span class="no">Name</span> <span class="no">Array</span>
<span class="p">[</span><span class="mi">3</span> <span class="mi">3</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
    <span class="mf">1.0000</span>     <span class="mf">4.0000</span>     <span class="mf">6.0000</span>
    <span class="mf">4.0000</span>    <span class="mf">11.0000</span>     <span class="mf">2.0000</span>
   <span class="o">-</span><span class="mf">5.0000</span>     <span class="mf">8.0000</span>    <span class="mf">10.0000</span>

<span class="o">=&gt;</span> <span class="c1">#&lt;ArrayFire::Af_Array:0x00000001762f68&gt;</span>

</code></pre></div></div>
<p>It works!.</p>

<h1 id="lapack-routines">LAPACK Routines</h1>

<p>LAPACK routines similar to BLAS ones are singleton methods.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Lapack</span> <span class="o">=</span> <span class="n">rb_define_class_under</span><span class="p">(</span><span class="n">ArrayFire</span><span class="p">,</span> <span class="s">"LAPACK"</span><span class="p">,</span> <span class="n">rb_cObject</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"svd_func"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_svd_func</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"svd_inplace_func"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_svd_inplace_func</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"lu_func"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_lu_func</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"lu_inplace_func"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_lu_inplace_func</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"qr_func"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_qr_func</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"qr_inplace_func"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_qr_inplace_func</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"cholesky_func"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_cholesky_func</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"cholesky_inplace_func"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_cholesky_inplace_func</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"solve_func"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_solve_func</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"solve_lu_func"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_solve_lu_func</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"inverse"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_inverse</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"rank"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_rank</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"det"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_det</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"norm"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_norm</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">rb_define_singleton_method</span><span class="p">(</span><span class="n">Lapack</span><span class="p">,</span> <span class="s">"is_lapack_available"</span><span class="p">,</span> <span class="p">(</span><span class="n">METHOD</span><span class="p">)</span><span class="n">arf_is_lapack_available</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">LAPACK.svd</code> must return multiple objects and hence calls <code class="language-plaintext highlighter-rouge">LAPACK.arf_svd_func</code>. The implementation
is as follows.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">static</span> <span class="n">VALUE</span> <span class="nf">arf_svd_func</span><span class="p">(</span><span class="n">VALUE</span> <span class="n">self</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">u_val</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">s_val</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">vt_val</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">val</span><span class="p">){</span>
  <span class="n">afstruct</span><span class="o">*</span> <span class="n">input</span><span class="p">;</span>
  <span class="n">afstruct</span><span class="o">*</span> <span class="n">u</span><span class="p">;</span>
  <span class="n">afstruct</span><span class="o">*</span> <span class="n">s</span><span class="p">;</span>
  <span class="n">afstruct</span><span class="o">*</span> <span class="n">vt</span><span class="p">;</span>

  <span class="n">Data_Get_Struct</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">afstruct</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span>
  <span class="n">Data_Get_Struct</span><span class="p">(</span><span class="n">u_val</span><span class="p">,</span> <span class="n">afstruct</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
  <span class="n">Data_Get_Struct</span><span class="p">(</span><span class="n">s_val</span><span class="p">,</span> <span class="n">afstruct</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
  <span class="n">Data_Get_Struct</span><span class="p">(</span><span class="n">vt_val</span><span class="p">,</span> <span class="n">afstruct</span><span class="p">,</span> <span class="n">vt</span><span class="p">);</span>

  <span class="n">af_svd</span><span class="p">(</span><span class="o">&amp;</span><span class="n">u</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">vt</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">,</span> <span class="n">input</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">Qtrue</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="nn">ArrayFire</span>
  <span class="k">class</span> <span class="nc">LAPACK</span>

    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">svd</span><span class="p">(</span><span class="n">af_array</span><span class="p">)</span>
      <span class="n">u</span> <span class="o">=</span>  <span class="no">ArrayFire</span><span class="o">::</span><span class="no">Af_Array</span><span class="p">.</span><span class="nf">new</span>
      <span class="n">s</span> <span class="o">=</span>  <span class="no">ArrayFire</span><span class="o">::</span><span class="no">Af_Array</span><span class="p">.</span><span class="nf">new</span>
      <span class="n">vt</span> <span class="o">=</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">Af_Array</span><span class="p">.</span><span class="nf">new</span>
      <span class="no">ArrayFire</span><span class="o">::</span><span class="no">LAPACK</span><span class="p">.</span><span class="nf">svd_func</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vt</span><span class="p">,</span> <span class="n">af_array</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vt</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">LAPACK.det</code> calls <code class="language-plaintext highlighter-rouge">af_det</code> to calculate the determinant. Currently, I haven’t
created support for complex dtype. So, I have ignored the imaginary part of
the result if it is not a real number.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">static</span> <span class="n">VALUE</span> <span class="nf">arf_det</span><span class="p">(</span><span class="n">VALUE</span> <span class="n">self</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">val</span><span class="p">){</span>
  <span class="n">afstruct</span><span class="o">*</span> <span class="n">matrix</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">det_real</span><span class="p">,</span> <span class="n">det_imag</span><span class="p">;</span>

  <span class="n">Data_Get_Struct</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">afstruct</span><span class="p">,</span> <span class="n">matrix</span><span class="p">);</span>

  <span class="n">af_det</span><span class="p">(</span><span class="o">&amp;</span><span class="n">det_real</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">det_imag</span><span class="p">,</span> <span class="n">matrix</span><span class="o">-&gt;</span><span class="n">carray</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">DBL2NUM</span><span class="p">(</span><span class="n">det_real</span><span class="p">);</span>
<span class="p">}</span>


</code></pre></div></div>

<p>Now, we can check the elementwise operations using <code class="language-plaintext highlighter-rouge">pry</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">rake</span> <span class="n">pry</span>
<span class="n">pry</span> <span class="o">-</span><span class="n">r</span> <span class="s1">'./lib/arrayfire.rb'</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">matrix</span> <span class="o">=</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">Af_Array</span><span class="p">.</span><span class="nf">new</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="no">No</span> <span class="no">Name</span> <span class="no">Array</span>
<span class="p">[</span><span class="mi">4</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
    <span class="mf">1.0000</span>     <span class="mf">2.0000</span>
    <span class="mf">3.0000</span>     <span class="mf">4.0000</span>
    <span class="mf">5.0000</span>     <span class="mf">6.0000</span>
    <span class="mf">7.0000</span>     <span class="mf">8.0000</span>

<span class="o">=&gt;</span> <span class="c1">#&lt;ArrayFire::Af_Array:0x0000000265cbe0&gt;</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">u</span> <span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vt</span> <span class="o">=</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">LAPACK</span><span class="p">.</span><span class="nf">svd</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="c1">#&lt;ArrayFire::Af_Array:0x000000026ff070&gt;, #&lt;ArrayFire::Af_Array:0x000000026ff048&gt;, #&lt;ArrayFire::Af_Array:0x000000026ff020&gt;]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">Util</span><span class="p">.</span><span class="nf">print_array</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="no">No</span> <span class="no">Name</span> <span class="no">Array</span>
<span class="p">[</span><span class="mi">4</span> <span class="mi">4</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
   <span class="o">-</span><span class="mf">0.1525</span>    <span class="o">-</span><span class="mf">0.8226</span>    <span class="o">-</span><span class="mf">0.3945</span>    <span class="o">-</span><span class="mf">0.3800</span>
   <span class="o">-</span><span class="mf">0.3499</span>    <span class="o">-</span><span class="mf">0.4214</span>     <span class="mf">0.2428</span>     <span class="mf">0.8007</span>
   <span class="o">-</span><span class="mf">0.5474</span>    <span class="o">-</span><span class="mf">0.0201</span>     <span class="mf">0.6979</span>    <span class="o">-</span><span class="mf">0.4614</span>
   <span class="o">-</span><span class="mf">0.7448</span>     <span class="mf">0.3812</span>    <span class="o">-</span><span class="mf">0.5462</span>     <span class="mf">0.0407</span>

<span class="o">=&gt;</span> <span class="kp">true</span>
<span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">Util</span><span class="p">.</span><span class="nf">print_array</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="no">No</span> <span class="no">Name</span> <span class="no">Array</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
   <span class="mf">14.2691</span>
    <span class="mf">0.6268</span>

<span class="o">=&gt;</span> <span class="kp">true</span>
<span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">Util</span><span class="p">.</span><span class="nf">print_array</span><span class="p">(</span><span class="n">vt</span><span class="p">)</span>
<span class="no">No</span> <span class="no">Name</span> <span class="no">Array</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
   <span class="o">-</span><span class="mf">0.6414</span>    <span class="o">-</span><span class="mf">0.7672</span>
    <span class="mf">0.7672</span>    <span class="o">-</span><span class="mf">0.6414</span>

<span class="o">=&gt;</span> <span class="kp">true</span>
<span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">left</span> <span class="o">=</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">Af_Array</span><span class="p">.</span><span class="nf">new</span> <span class="mi">2</span> <span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span> <span class="p">,</span> <span class="mi">2</span> <span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="no">No</span> <span class="no">Name</span> <span class="no">Array</span>
<span class="p">[</span><span class="mi">3</span> <span class="mi">3</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
    <span class="mf">1.0000</span>     <span class="mf">4.0000</span>    <span class="o">-</span><span class="mf">5.0000</span>
    <span class="mf">4.0000</span>    <span class="mf">11.0000</span>     <span class="mf">8.0000</span>
    <span class="mf">6.0000</span>     <span class="mf">2.0000</span>    <span class="mf">10.0000</span>

<span class="o">=&gt;</span> <span class="c1">#&lt;ArrayFire::Af_Array:0x00000002984c78&gt;</span>
<span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">det</span> <span class="o">=</span> <span class="no">ArrayFire</span><span class="o">::</span><span class="no">LAPACK</span><span class="p">.</span><span class="nf">det</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="mf">415.9999694824219</span>

</code></pre></div></div>

<p>It works!</p>

<h1 id="conclusion">Conclusion</h1>

<p>We can now use <code class="language-plaintext highlighter-rouge">ArrayFire-rb</code> for linear algebra since the BLAS and LAPACK routines are in
place. Also, the performance is outstanding.</p>

<p>In the next blog, I will explain about using the Random Engine generator and Statistics methods for ArrayFire.</p>

<div id="disqus_thread"></div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//prasunanandblog.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</p>
              </div>
            </div>

            <div class="related-blog-wraper wow fadeInUp">
              <h6>Related Blog</h6>

              

              <div class="related-blog-item latest-post-item wow fadeInUp" data-wow-delay="0.1s">
                <a href="/cuda/opencl/ruby/rbcuda/2018/02/24/rubygrant17-rbcuda-installation-and-architecture.html.html">
                  <div class="latest-post-item-image">
                    <img src="/images/banner.png" alt="#">
                  </div>
                  <div class="latest-post-item-content">
                    <h2>RbCUDA: Installation and Architecture</h2>
                    <span>24 February 2018</span>
                  </div>
                </a>
              </div>
              

              <div class="related-blog-item latest-post-item wow fadeInUp" data-wow-delay="0.1s">
                <a href="/cuda/opencl/ruby/rbcuda/2017/12/30/rubygrant17-rbcuda-introduction.html.html">
                  <div class="latest-post-item-image">
                    <img src="/images/banner.png" alt="#">
                  </div>
                  <div class="latest-post-item-content">
                    <h2>RbCUDA: CUDA bindings for Ruby</h2>
                    <span>30 December 2017</span>
                  </div>
                </a>
              </div>
              

            </div>
          </div>
          

          <div class="col-12 col-md-12 col-lg-3">
            <div class="blog-page-right-wraper">
              <div class="search-wraper wow fadeInUp" data-wow-delay="0.2s">
                <h6>Search</h6>
                <div class="search-form-wraper">
                  <form action="/search.html" method="GET">
                    <input type="text" name="query" id="search-box" placeholder="Search">
                    <button class="btn-bg"><img src="/images/icons/search.svg" alt="#"></button>
                  </form>
                </div>
              </div>

              <div class="latest-post-wraper wow fadeInUp" data-wow-delay="0.3s">
                <h6>Latest Post</h6>
                
                <div class="latest-post-item wow fadeInUp" data-wow-delay="0.1s">
                  <a href="/cuda/opencl/ruby/rbcuda/2018/02/24/rubygrant17-rbcuda-installation-and-architecture.html">
                    <div class="latest-post-item-image">
                      <img src="/images/banner.png" alt="#">
                    </div>
                    <div class="latest-post-item-content">
                      <h2>RbCUDA: Installation and Architecture</h2>
                      <span>24 February 2018</span>
                    </div>
                  </a>
                </div>

                
                <div class="latest-post-item wow fadeInUp" data-wow-delay="0.1s">
                  <a href="/cuda/opencl/ruby/rbcuda/2017/12/30/rubygrant17-rbcuda-introduction.html">
                    <div class="latest-post-item-image">
                      <img src="/images/banner.png" alt="#">
                    </div>
                    <div class="latest-post-item-content">
                      <h2>RbCUDA: CUDA bindings for Ruby</h2>
                      <span>30 December 2017</span>
                    </div>
                  </a>
                </div>

                
                <div class="latest-post-item wow fadeInUp" data-wow-delay="0.1s">
                  <a href="/arrayfire/cuda/opencl/ruby/2017/08/28/gsoc17-project-report.html">
                    <div class="latest-post-item-image">
                      <img src="/images/gsoc2017.png" alt="#">
                    </div>
                    <div class="latest-post-item-content">
                      <h2>GSoC 2017: Creating the fastest math libraries for Ruby by using the GPU through OpenCL and ArrayFire.</h2>
                      <span>28 August 2017</span>
                    </div>
                  </a>
                </div>

                
              </div>

              <div class="tags-wraper wow fadeInUp" data-wow-delay="0.4s">
                <h6>Tag Clouds</h6>
                <div class="tag-clouds">
                  <a href="#">Engineering</a>
                  <a href="#">Infrastructure</a>
                  <a href="#">Technology</a>
                  <a href="#">Future</a>
                  <a href="#">Infrastructure</a>
                  <a href="#">Future</a>
                  <a href="#">Engineering</a>
                  <a href="#">Technology</a>
                  <a href="#">Engineering</a>
                  <a href="#">Infrastructure</a>
                  <a href="#">Technology</a>
                  <a href="#">Future</a>
                </div>
              </div>

            </div>
          </div>



        </div>
      </div>
    </section>

    <section id="updates">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <div class="updates-wraper">
              <div class="updates-image wow fadeInUp" data-wow-delay="0.2s">
                <img src="/images/image2.svg" alt="#">
              </div>
              <div class="updates-form header-form wow fadeInUp" data-wow-delay="0.2s">
                <h5 class="font-h5">Subscribe for exclusive</h5>
                <h3 class="font-h3">news and updates!</h3>
                <form action="https://zasper.io/newsletter" method="POST">
                  <div class="form-group">
                    <input type="email" name="email" placeholder="Enter your email">
                    <button type="submit" class="btn-bg hover-bg">Subscribe</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="footer">
      <div class="container">
        <div class="row">
          <div class="col-12 col-md-4">
            <div class="footer-info wow fadeInUp" data-wow-delay="0.2s">
              <div class="footer-image wow fadeInUp" data-wow-delay="0.1s">
                <img src="/images/logo.svg" alt="#">
              </div>
              <div class="footer-content wow fadeInUp" data-wow-delay="0.2s">
                <p>Zasper strives to be at the forefront of the AI Revolution that is taking place around the world. We want to ease the pain of Data teams by enabling them to develop and deploy their AI solutions right from rapid prototyping to shipping into production.</p>
              </div>
              <div class="footer-social wow fadeInUp" data-wow-delay="0.3s">
                <a href="https://www.linkedin.com/company/zasper"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
                <a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                <a href="https://github.com/zasperio"><i class="fa fa-github" aria-hidden="true"></i></a>
              </div>
            </div>
          </div>
          <div class="col-12 col-md-8">
            <div class="footer-menu-wraper wow fadeInUp" data-wow-delay="0.4s">
              <div>
                <div class="footer-menu wow fadeInUp" data-wow-delay="0.1s">
                  <h6>Company</h6>
                  <a href="https://zasper.io/product">Product</a>
                  <a href="https://zasper.io/pricing">Pricing</a>
                  <a href="https://zasper.io/partners">Partners</a>
                  <a href="https://zasper.io/careers">Careers</a>
                  <a href="https://zasper.io/support">Support</a>
                </div>
              </div>
              <div>
                <div class="footer-menu wow fadeInUp" data-wow-delay="0.3s">
                  <h6>Solutions</h6>
                  <a href="https://zasper.io/solutions/banking">Banking</a>
                  <a href="https://zasper.io/solutions/telecom">Telecom</a>
                  <a href="https://zasper.io/solutions/oil-and-gas">Oil and Gas</a>
                  <a href="https://zasper.io/solutions/healthcare">Healthcare</a>
                  <a href="https://zasper.io/solutions/">View More</a>
                </div>
              </div>
              <div>
                <div class="footer-menu wow fadeInUp" data-wow-delay="0.5s">
                  <h6>Community</h6>
                  <a href="/">Blog</a>
                  <a href="https://docs.zasper.io">Docs</a>
                  <a href="https://zasper.io/contact-us">Contact Us</a>
                </div>
              </div>
              <div>
                <div class="footer-menu wow fadeInUp" data-wow-delay="0.6s">
                  <h6>Legal</h6>
                  <a href="https://zasper.io/terms-and-conditions">Terms and Conditions</a>
                  <a href="https://zasper.io/privacy">Privacy Policy</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="copyright">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <div class="copyright-text wow fadeInUp" data-wow-delay="0.2s">
              <p>©2021 zasper ai labs pvt ltd | All rights reserved.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- JavaScripts -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/wow.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/main.js"></script>

  </body>
</html>

